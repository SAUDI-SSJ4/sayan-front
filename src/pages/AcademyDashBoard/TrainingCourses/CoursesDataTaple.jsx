// import { AgGridReact } from "ag-grid-react";
// import React, { useEffect, useMemo, useState } from "react";
// import { Spinner } from "react-bootstrap";
// import Swal from "sweetalert2";
// import axiosInstance from "../../../../axios";
// import { Link } from "react-router-dom";
// import Cookies from "js-cookie";

// function CoursesDataTaple({ CoursesData: rowData }) {

//   const imageData = (params) => {
//     return (
//       <img
//         src={params.value}
//         alt="Course"
//         style={{ width: "20px", height: "20px" }}
//       />
//     );
//   };

//   const courseDetailsFun = (p) => {
//     return (
//       <>
//         <Link to={`/student/courseDetails/${p.value}`}>ุงูุชูุงุตูู</Link>
//       </>
//     );
//   };

//   const sweetFunctiontoAddFav = (e) => {
//     Swal.fire({
//       title: "ุงูุงุถุงูุฉ ุงูู ุงูููุถูุฉ",
//       text: "ูู ุชุฑูุฏ ุงุถุงูุฉ ูุฐุฉ ุงูุฏูุฑุฉ ุงูู ุงูููุถูุฉ",
//       icon: "warning",
//       showCancelButton: true,
//       confirmButtonColor: "#3085d6",
//       cancelButtonColor: "#d33",
//       confirmButtonText: "ุงุถุงูุฉ",
//       cancelButtonText: "ูุง",
//     }).then((result) => {
//       if (result.isConfirmed) {
//         console.log(e);
//         axiosInstance
//           .post(
//             `/toggle`,
//             { course_id: e.value },
//             {
//               headers: {
//                 Authorization: `Bearer ${ Cookies.get("token")}`,
//               },
//             }
//           )
//           .then((res) => res.data)
//           .then((data) => {
//             console.log(data);
//             Swal.fire({
//               title: "๐ุชูุช ุงูุงุถุงูุฉ",
//               text: "ุชู ุงุถุงูุฉ ุงูุฏูุฑุฉ ุงูุชุนููููุฉ ุงูู ุงูููุถูุฉ",
//               icon: "success",
//             });
//           });
//       }
//     });
//   };

//   const addCourseToFav = (p) => {
//     return (
//       <>
//         <button
//           onClick={() => {
//             sweetFunctiontoAddFav(p);
//           }}
//         >
//           ุงุถุงูุฉ
//         </button>
//       </>
//     );
//   };

//   const defaultColDef = useMemo(
//     () => ({
//       flex: 1,
//       filter: true,
//       // floatingFilter: true,
//       editable: false,
//     }),
//     []
//   );

//   // SweetAlert for Delete Confirmation
//   const handleDelete = (courseId) => {
//     Swal.fire({
//       title: "ุญุฐู ุงูุฏูุฑุฉ",
//       text: "ูู ุชุฑูุฏ ุจุงูุชุฃููุฏ ุญุฐู ูุฐู ุงูุฏูุฑุฉุ",
//       icon: "warning",
//       showCancelButton: true,
//       confirmButtonColor: "#d33",
//       cancelButtonColor: "#3085d6",
//       confirmButtonText: "ูุนูุ ุงุญุฐููุง!",
//       cancelButtonText: "ุฅูุบุงุก",
//     }).then((result) => {
//       if (result.isConfirmed) {
//         // API request to delete course
//         axiosInstance
//           .delete(`/courses/${courseId}`, {
//             headers: {
//               Authorization: `Bearer ${Cookies.get("token")}`,
//             },
//           })
//           .then((response) => {
//             Swal.fire("ุชู ุงูุญุฐู!", "ุชู ุญุฐู ุงูุฏูุฑุฉ ุจูุฌุงุญ", "success");
//             // You can refresh the data here or remove the deleted item from rowData
//           })
//           .catch((error) => {
//             console.error("Error deleting course:", error);
//             Swal.fire("ุฎุทุฃ", "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูุฏูุฑุฉ", "error");
//           });
//       }
//     });
//   };

//   // Add Edit and Delete buttons
//   const actionCellRenderer = (params) => {
//     return (
//       <div style={{ display: "flex", justifyContent: "center" }}>
//         <Link to={`/courses/edit/${params.value}`}>
//           <button className="btn btn-primary mx-1">ุชุนุฏูู</button>
//         </Link>
//         <button
//           onClick={() => handleDelete(params.value)}
//           className="btn btn-danger mx-1"
//         >
//           ุญุฐู
//         </button>
//       </div>
//     );
//   };

//   const handleEdit  =(value) => {
//     console.log(value);

//   }

//   const colDefs = useMemo(
//     () => [
//       {
//         field: "id",  // Assuming the course ID is passed in 'id'
//         headerName: "ุงูุงุฌุฑุงุกุงุช",
//         flex: 1,
//         cellRendererFramework: (params) => (
//           <div style={{ display: "flex", justifyContent: "center", gap: "10px" }}>
//             <button
//               onClick={() => handleEdit(params.value)}  // Call the edit function
//               className="btn btn-primary"
//             >
//               ุชุนุฏูู
//             </button>
//             <button
//               onClick={() => handleDelete(params.value)}  // Call the delete function
//               className="btn btn-danger"
//             >
//               ุญุฐู
//             </button>
//           </div>
//         ),
//         cellStyle: { textAlign: "center" },
//       },
//       {
//         field: "category",
//         headerName: "ุงููุฆุฉ",
//         flex: 1,
//         cellStyle: { textAlign: "center" },
//         // cellRenderer: courseDetailsFun,
//       },
//       {
//         field: "type",
//         headerName: "ุงูููุน",
//         flex: 1,
//         cellStyle: { textAlign: "center" },
//         valueFormatter: (params) => {
//           if (params.value === "live") {
//             return "ูุจุงุดุฑุฉ";
//           } else if (params.value === "recorded") {
//             return "ุชูุงุนููุฉ";
//           } else if (params.value === "attend") {
//             return "ุญุถูุฑูุฉ";
//           } else {
//             return params.value;
//           }
//         },
//       },
//       {
//         field: "level",
//         headerName: "ุงููุณุชูู", // Set a fixed header name
//         flex: 1,
//         // checkboxSelection: true,
//         cellStyle: { textAlign: "center" },
//         valueFormatter: (params) => {
//           if (params.value === "intermediate") {
//             return "ูุชูุณุท";
//           } else if (params.value === "advanced") {
//             return "ูุชูุฏู";
//           } else if (params.value === "beginner") {
//             return "ูุจุชุฏุฆ";
//           } else {
//             return params.value;
//           }
//         },
//       },

//       {
//         field: "trainer",
//         headerName: "ุงุณู ุงููุฏุฑุจ",
//         flex: 1,
//         cellStyle: { textAlign: "center" },
//       },
//       {
//         field: "price",
//         headerName: "ุงูุณุนุฑ", // Set a fixed header name
//         cellStyle: { textAlign: "center" },
//         valueFormatter: (params) => "ุฑูุงู " + params.value.toLocaleString(),
//         cellClassRules: {
//           "red-cell": (params) => params.value > 100,
//           "blue-cell": (params) => params.value <= 100,
//         },
//       },
//       {
//         field: "title",
//         headerName: "ุงุณู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ",
//         flex: 3,
//         cellStyle: { textAlign: "center" },
//       },

//     ],
//     [rowData]
//   );

//   return (
//     <div className="ag-theme-quartz overflow-x-scroll" style={{ height: 600 }}>
//       <AgGridReact
//         rowData={rowData}
//         columnDefs={colDefs}
//         rowSelection="multiple"
//         pagination
//         paginationPageSize={8}
//         paginationPageSizeSelector={[4, 8]}
//         defaultColDef={defaultColDef}
//       />
//     </div>
//   );
// }

// export default CoursesDataTaple;

import React from "react";
import { Link } from "react-router-dom";
import Swal from "sweetalert2";
import Cookies from "js-cookie";
import axios from "axios";
import { useDispatch } from "react-redux";
import { getAcademyCoursesThunk } from "../../../../redux/courses/CourseThunk";

function CoursesDataTable({ CoursesData, academyId }) {
  const dispatch = useDispatch();
  const handleDelete = (courseId) => {
    Swal.fire({
      title: "ุญุฐู ุงูุฏูุฑุฉ",
      text: "ูู ุชุฑูุฏ ุจุงูุชุฃููุฏ ุญุฐู ูุฐู ุงูุฏูุฑุฉุ",
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#d33",
      cancelButtonColor: "#3085d6",
      confirmButtonText: "ูุนูุ ุงุญุฐููุง!",
      cancelButtonText: "ุฅูุบุงุก",
    }).then((result) => {
      if (result.isConfirmed) {
        const baseUrl = new URL(import.meta.env.VITE_SERVER_DEV).origin;

        axios
          .delete(`${baseUrl}/api/v1/academies/courses/${courseId}`, {
            headers: {
              Authorization: `Bearer ${Cookies.get("academy_token")}`,
            },
          })
          .then(() => {
            Swal.fire("ุชู ุงูุญุฐู!", "ุชู ุญุฐู ุงูุฏูุฑุฉ ุจูุฌุงุญ", "success");
            dispatch(getAcademyCoursesThunk(academyId)).unwrap();
          })
          .catch(() => Swal.fire("ุฎุทุฃ", "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุญุฐู", "error"));
      }
    });
  };

  return (
    <div className="overflow-x-auto shadow-sm  rounded-lg">
      <table className="min-w-full bg-white border border-gray-300">
        <thead>
          <tr className="bg-white  text-blue-900">
            <th className="py-4 px-2 pe-5">
              <input type="checkbox" />
            </th>
            <th className="py-4 px-2">ุงูุฅุฌุฑุงุกุงุช</th>
            <th className="py-4 px-2">ุงููุฆุฉ</th>
            <th className="py-4 px-2">ุงูููุน</th>
            <th className="py-4 px-2">ุงููุณุชูู</th>
            <th className="py-4 px-2">ุงุณู ุงููุฏุฑุจ</th>
            <th className="py-4 px-2">ุงูุณุนุฑ</th>
            <th className="py-4 px-2">ุงุณู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ</th>
          </tr>
        </thead>
        <tbody>
          {CoursesData.map((course) => (
            <tr key={course.id} className="text-center border border-gray-300">
              <td className="p-2 border border-gray-300">
                <input type="checkbox" />
              </td>
              <td className="p-2 border border-gray-300 flex justify-center gap-2">
                <Link to={`/courses/edit/${course.id}`}>
                  <button className="btn btn-primary">โ๏ธ</button>
                </Link>
                <button
                  onClick={() => handleDelete(course.id)}
                  className="btn btn-danger"
                >
                  ๐๏ธ
                </button>
              </td>
              <td className="p-2 border border-gray-300">{course.category}</td>
              <td className="p-2 border border-gray-300">
                {course.type === "live"
                  ? "ูุจุงุดุฑุฉ"
                  : course.type === "recorded"
                  ? "ุชูุงุนููุฉ"
                  : course.type === "attend"
                  ? "ุญุถูุฑูุฉ"
                  : course.type}
              </td>
              <td className="p-2 border border-gray-300">
                {course.level === "intermediate"
                  ? "ูุชูุณุท"
                  : course.level === "advanced"
                  ? "ูุชูุฏู"
                  : course.level === "beginner"
                  ? "ูุจุชุฏุฆ"
                  : course.level}
              </td>
              <td className="p-2 border border-gray-300">{course.trainer}</td>
              <td className="p-2 border border-gray-300">
                ุฑูุงู {course.price.toLocaleString()}
              </td>
              <td className="p-2 border border-gray-300">{course.title}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}

export default CoursesDataTable;
